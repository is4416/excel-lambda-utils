= LAMBDA(Line,Point, LET(
  X  , TAKE(Line,,1),
  XX , TAKE(DROP(Line,,2),,1),
  XXX, TAKE(Point,,1),

  Y  , TAKE(DROP(Line,,1),,1),
  YY , TAKE(DROP(Line,,3),,1),
  YYY, TAKE(DROP(Point,,1),,1),

  DX , XX - X,
  DY , YY - Y,
  L  , DX^2 + DY^2,
  T  , IF(L = 0,
    NA(),
    ((XXX - X) * DX + (YYY - Y) * DY) / L
  ),

  FX, X + T * DX,
  FY, Y + T * DY,

  HSTACK(FX, FY, SQRT((FX - XXX)^2 + (FY - YYY)^2))
))
